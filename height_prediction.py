# -*- coding: utf-8 -*-
"""height_prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1picqgfGBnWURUPkOmd8r5w1VJRpyuK8P
"""

!pip install pandas

!pip install -U scikit-learn

!pip install numpy

!pip install matplotlib

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

from google.colab import files
uploaded = files.upload()

dataset = pd.read_csv('age_height.csv')

print(dataset.shape)
print(dataset.head(5))

x = dataset.iloc[:,:-1].values
x

y = dataset.iloc[:,-1].values
y

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.20,random_state=0)

from sklearn.tree import DecisionTreeRegressor
model =  DecisionTreeRegressor()
model.fit(x_train,y_train)

x_val = np.arange(min(x_train), max(x_train), 0.01)
x_val = x_val.reshape((len(x_val), 1))

plt.scatter(x_train, y_train, color='green')
plt.plot(x_val, model.predict(x_val), color='red')

plt.title('age vs height (training set)')
plt.xlabel('age')
plt.ylabel('height')
plt.show()

y_pred = model.predict(x_test)

from sklearn.metrics import r2_score, mean_squared_error
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
print("Root Mean Square Error:", rmse)

r2score = r2_score(y_test, y_pred)
print("R2 Score", r2score * 100)

ip = [[10]]
op = model.predict(ip)
print(op)